# Домашнее задание к занятию "Компьютерные сети. Лекция 2"

### 1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?
```
$ ip -c -br link
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP> 
eth0             UP             00:0c:29:38:56:27 <BROADCAST,MULTICAST,UP,LOWER_UP> 
```
Для систем Windows есть команда `ipconfig`. Она выведет информацию о сетевых интерфейсах, их IP, MAC, default gateway и так далее.

### 2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

Используются протоколы LLDP и CDP  
В linux существует пакет lldpd. Командой lldpctl можем увидеть соседствующее оборудование.

### 3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.


Используется технология VLAN. В linux используется пакеты vlan и iproute2.

````bash
$ sudo /sbin/vconfig add eth0 100
$ sudo /sbin/ifconfig eth0.100 80.80.80.80 netmask 255.255.255.255 up
$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:38:56:27 brd ff:ff:ff:ff:ff:ff
    inet 192.168.134.128/24 brd 192.168.134.255 scope global dynamic noprefixroute eth0
       valid_lft 1190sec preferred_lft 1190sec
    inet6 fe80::20c:29ff:fe38:5627/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
3: eth0.100@eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 00:0c:29:38:56:27 brd ff:ff:ff:ff:ff:ff
    inet 80.80.80.80/32 brd 80.255.255.255 scope global eth0.100
       valid_lft forever preferred_lft forever
    inet6 fe80::20c:29ff:fe38:5627/64 scope link 
       valid_lft forever preferred_lft forever
````
### 4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

В Linux существует механизм объединения интерфейсов bonding. Пример конфигурации bonding для интерфейсов eth0 и eth1:  
```bash
auto bond0
iface bond0 inet dhcp
   bond-slaves none
   bond-mode active-backup
   bond-miimon 100

auto eth0
   iface eth0 inet manual
   bond-master bond0
   bond-primary eth0 eth1

auto eth1
iface eth1 inet manual
   bond-master bond0
   bond-primary eth0 eth1
```

##### Типы агрегации (объединения) интерфейсов в Linux  
mode=0 (balance-rr)  
Этот режим используется по-умолчанию, если в настройках не указано другое. balance-rr обеспечивает балансировку нагрузки и отказоустойчивость. В данном режиме пакеты отправляются "по кругу" от первого интерфейса к последнему и сначала. Если выходит из строя один из интерфейсов, пакеты отправляются на остальные оставшиеся.При подключении портов к разным коммутаторам, требует их настройки.  

mode=1 (active-backup)  
При active-backup один интерфейс работает в активном режиме, остальные в ожидающем. Если активный падает, управление передается одному из ожидающих. Не требует поддержки данной функциональности от коммутатора.  

mode=2 (balance-xor)  
Передача пакетов распределяется между объединенными интерфейсами по формуле ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. Один и тот же интерфейс работает с определённым получателем. Режим даёт балансировку нагрузки и отказоустойчивость.  

mode=3 (broadcast)  
Происходит передача во все объединенные интерфейсы, обеспечивая отказоустойчивость.  

mode=4 (802.3ad)  
Это динамическое объединение портов. В данном режиме можно получить значительное увеличение пропускной способности как входящего так и исходящего трафика, используя все объединенные интерфейсы. Требует поддержки режима от коммутатора, а так же (иногда) дополнительную настройку коммутатора.  

mode=5 (balance-tlb)  
Адаптивная балансировка нагрузки. При balance-tlb входящий трафик получается только активным интерфейсом, исходящий - распределяется в зависимости от текущей загрузки каждого интерфейса. Обеспечивается отказоустойчивость и распределение нагрузки исходящего трафика. Не требует специальной поддержки коммутатора.  

mode=6 (balance-alb)  
Адаптивная балансировка нагрузки (более совершенная). Обеспечивает балансировку нагрузки как исходящего (TLB, transmit load balancing), так и входящего трафика (для IPv4 через ARP). Не требует специальной поддержки коммутатором, но требует возможности изменять MAC-адрес устройства.  

### 5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

С маской /29 будет 8 адресов c учетом broadcast адреса и адреса самой сети, т.е. для хостов можно использовать 6 адресов. Из сети с маской /24 можно получить 32 подсети с маской /29.
```
$ ipcalc 10.10.10.0/29
Address:   10.10.10.0           00001010.00001010.00001010.00000 000
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Wildcard:  0.0.0.7              00000000.00000000.00000000.00000 111
=>
Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
Hosts/Net: 6                     Class A, Private Internet
```
Внутри сети 10.10.10.0/24 есть подсети 10.10.10.0/29, 10.10.10.8/29, 10.10.10.16/29 и так далее с шагом 8.

### 6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

В данной ситуации есть свободный частный диапазон 100.64.0.0/10. Для использования 40-50 хостов достаточно маски 26 с емкостью до 62 рабочих хостов.

### 7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

Linux:  

проверить ARP таблицу: `arp -n`  
очитстить ARP кеш: `ip -s -s neigh flush all` (нужны права root)   
удалить один IP: ` arp -d <ip-адрес>`   

Windows:  

проверить ARP таблицу: `ё`arp -a`ё`  
очитстить ARP кеш: `netsh interface ip delete arpcache`   
удалить один IP: `arp -d <ip-адрес>`  

